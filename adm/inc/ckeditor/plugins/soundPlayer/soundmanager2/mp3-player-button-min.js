/**
 * SoundManager 2 Demo: Play MP3 links via button
 * ----------------------------------------------
*/
function BasicMP3Player(){var e=this,s=this,n=soundManager,t=navigator.userAgent.match(/ipad|iphone/i),a=navigator.userAgent.match(/msie/i);this.excludeClass="button-exclude",this.links=[],this.sounds=[],this.soundsByURL={},this.indexByURL={},this.lastSound=null,this.soundCount=0,this.config={playNext:!1,autoPlay:!1},this.css={sDefault:"sm2_button",sLoading:"sm2_loading",sPlaying:"sm2_playing",sPaused:"sm2_paused"},this.includeClass=this.css.sDefault,this.addEventHandler="undefined"!=typeof window.addEventListener?function(e,s,n){return e.addEventListener(s,n,!1)}:function(e,s,n){e.attachEvent("on"+s,n)},this.removeEventHandler="undefined"!=typeof window.removeEventListener?function(e,s,n){return e.removeEventListener(s,n,!1)}:function(e,s,n){return e.detachEvent("on"+s,n)},this.classContains=function(e,s){return"undefined"!=typeof e.className?e.className.match(new RegExp("(\\s|^)"+s+"(\\s|$)")):!1},this.addClass=function(s,n){return s&&n&&!e.classContains(s,n)?void(s.className=(s.className?s.className+" ":"")+n):!1},this.removeClass=function(s,n){return s&&n&&e.classContains(s,n)?void(s.className=s.className.replace(new RegExp("( "+n+")|("+n+")","g"),"")):!1},this.getSoundByURL=function(s){return"undefined"!=typeof e.soundsByURL[s]?e.soundsByURL[s]:null},this.isChildOfNode=function(e,s){if(!e||!e.parentNode)return!1;s=s.toLowerCase();do e=e.parentNode;while(e&&e.parentNode&&e.nodeName.toLowerCase()!==s);return e.nodeName.toLowerCase()===s?e:null},this.events={play:function(){s.removeClass(this._data.oLink,this._data.className),this._data.className=s.css.sPlaying,s.addClass(this._data.oLink,this._data.className)},stop:function(){s.removeClass(this._data.oLink,this._data.className),this._data.className=""},pause:function(){s.removeClass(this._data.oLink,this._data.className),this._data.className=s.css.sPaused,s.addClass(this._data.oLink,this._data.className)},resume:function(){s.removeClass(this._data.oLink,this._data.className),this._data.className=s.css.sPlaying,s.addClass(this._data.oLink,this._data.className)},finish:function(){if(s.removeClass(this._data.oLink,this._data.className),this._data.className="",s.config.playNext){var e=s.indexByURL[this._data.oLink.href]+1;e<s.links.length&&s.handleClick({target:s.links[e]})}}},this.stopEvent=function(e){return"undefined"!=typeof e&&"undefined"!=typeof e.preventDefault?e.preventDefault():"undefined"!=typeof window.event&&(window.event.returnValue=!1),!1},this.getTheDamnLink=a?function(e){return e&&e.target?e.target:window.event.srcElement}:function(e){return e.target},this.handleClick=function(s){if("undefined"!=typeof s.button&&s.button>1)return!0;var t,a,i,o=e.getTheDamnLink(s);return"a"===o.nodeName.toLowerCase()||(o=e.isChildOfNode(o,"a"))?(t=o.getAttribute("href"),o.href&&soundManager.canPlayLink(o)&&!e.classContains(o,e.excludeClass)&&e.classContains(o,e.includeClass)?(n._writeDebug("handleClick()"),a=o.href,i=e.getSoundByURL(a),i?i===e.lastSound?i.togglePause():(i.togglePause(),n._writeDebug("sound different than last sound: "+e.lastSound.id),e.lastSound&&e.stopSound(e.lastSound)):(i=n.createSound({id:"basicMP3Sound"+e.soundCount++,url:a,onplay:e.events.play,onstop:e.events.stop,onpause:e.events.pause,onresume:e.events.resume,onfinish:e.events.finish,type:o.type||null}),i._data={oLink:o,className:e.css.sPlaying},e.soundsByURL[a]=i,e.sounds.push(i),e.lastSound&&e.stopSound(e.lastSound),i.play()),e.lastSound=i,e.stopEvent(s)):!0):!0},this.stopSound=function(e){soundManager.stop(e.id),t||soundManager.unload(e.id)},this.init=function(){n._writeDebug("basicMP3Player.init()");var s,t,a=0,i=document.getElementsByTagName("a");for(s=0,t=i.length;t>s;s++)e.classContains(i[s],e.css.sDefault)&&!e.classContains(i[s],e.excludeClass)&&(e.links[a]=i[s],e.indexByURL[i[s].href]=a,a++);a>0&&(e.addEventHandler(document,"click",e.handleClick),e.config.autoPlay&&e.handleClick({target:e.links[0],preventDefault:function(){}})),n._writeDebug("basicMP3Player.init(): Found "+a+" relevant items.")},this.init()}var basicMP3Player=null;soundManager.setup({preferFlash:!1,onready:function(){basicMP3Player=new BasicMP3Player}});
